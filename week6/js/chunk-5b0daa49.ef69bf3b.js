(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5b0daa49"],{"01c6":function(t,e,a){},1799:function(t,e,a){"use strict";var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"page-wrap",attrs:{id:"pagination"}},[a("button",{staticClass:"page",attrs:{id:"prev"},on:{click:function(e){return t.changePage("m")}}},[t._v("«")]),t._l(t.pagination.total_pages,(function(e){return a("button",{key:e,staticClass:"page",class:{curpage:e===t.pagination.current_page},on:{click:function(a){return t.goToPage(e)}}},[t._v(t._s(e))])})),a("button",{staticClass:"page",attrs:{id:"next"},on:{click:function(e){return t.changePage("p")}}},[t._v("»")])],2)},i=[],n={name:"pagination",props:{pagination:Object},template:"#pagination",methods:{changePage:function(t){var e=this.pagination.current_page,a=this.pagination.total_pages;"p"===t?e<a&&this.$emit("update:pagination",this.pagination.current_page+=1):"m"===t&&e>1&&this.$emit("update:pagination",this.pagination.current_page-=1)},goToPage:function(t){this.$emit("update:pagination",this.pagination.current_page=t)}}},c=n,r=(a("ba16"),a("2877")),s=Object(r["a"])(c,o,i,!1,null,"2a9c838b",null);e["a"]=s.exports},2246:function(t,e,a){"use strict";a.r(e);var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"item-manage",attrs:{id:"item-manage"}},[a("button",{staticClass:"add",attrs:{"data-action":"add"},on:{click:function(e){return t.openPage()}}},[a("font-awesome-icon",{attrs:{icon:["fas","plus"]}}),t._v("新增")],1),a("button",{staticClass:"add circle",class:{show:t.addShow},attrs:{title:"新增商品","data-action":"add","track-by":"$index"},on:{click:function(e){return t.openPage()}}},[a("font-awesome-icon",{attrs:{icon:["fas","plus"]}})],1),a("table",[t._m(0),t._l(t.products,(function(e,o){return a("tr",{key:e.id,staticClass:"item-list",attrs:{"data-id":e.id,"data-index":o}},[a("td",{staticClass:"col"},[a("div",{staticClass:"text"},[t._v(t._s(e.category))])]),a("td",{staticClass:"col",style:{backgroundImage:"url("+e.imageUrl[0]+")"}}),a("td",{staticClass:"col"},[a("div",{staticClass:"text"},[t._v(t._s(e.title))])]),a("td",{staticClass:"col"},[a("div",{staticClass:"text"},[t._v(t._s(e.content))])]),a("td",{staticClass:"col"},[a("font-awesome-icon",{class:e.enabled?"check":"times",attrs:{icon:e.enabled?["fas","check"]:["fas","times"]}})],1),a("td",{staticClass:"col"},[t._v(t._s(e.origin_price))]),a("td",{staticClass:"col"},[t._v(t._s(e.price))]),a("td",{staticClass:"col"},[t._v(t._s(e.options?e.options.store:0))]),a("td",{staticClass:"col"},[a("button",{staticClass:"update",attrs:{"data-action":"update"},on:{click:function(e){return t.openPage(o)}}},[a("font-awesome-icon",{attrs:{icon:["fas","edit"]}}),t._v("修改")],1),a("button",{staticClass:"del",on:{click:function(e){return t.deleteProduct(o)}}},[a("font-awesome-icon",{attrs:{icon:["fas","trash-alt"]}}),t._v("刪除")],1)])])}))],2),a("productPage",{class:{open:t.productPage.open},attrs:{addNewItem:t.addNewItem},on:{"update:addNewItem":function(e){t.addNewItem=e},"update:add-new-item":function(e){t.addNewItem=e}}}),t.pagination.current_page?[a("pagination",{attrs:{pagination:t.pagination}})]:t._e(),a("vue-confirm-dialog")],2)},i=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("tr",{staticClass:"title"},[a("th",{staticClass:"col"},[t._v("分類")]),a("th",{staticClass:"col"},[t._v("圖片")]),a("th",{staticClass:"col"},[t._v("標題")]),a("th",{staticClass:"col"},[t._v("描述")]),a("th",{staticClass:"col"},[t._v("啟用狀態")]),a("th",{staticClass:"col"},[t._v("原價")]),a("th",{staticClass:"col"},[t._v("售價")]),a("th",{staticClass:"col"},[t._v("庫存")]),a("th",{staticClass:"col"},[t._v("編輯")])])}];a("d81d"),a("a4d3"),a("e01a"),a("d28b"),a("d3b7"),a("3ca3"),a("ddb0");function n(t){return n="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}var c=a("5530"),r=a("2f62"),s=a("1799"),d=a("2803"),u=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"newDataPage",attrs:{id:"newDataPage"},on:{click:t.toggle}},[a("div",{ref:"productPage",staticClass:"container"},[a("div",{staticClass:"loading",class:{show:t.loading}},[a("font-awesome-icon",{staticClass:"fa-3x fa-spin",attrs:{icon:["fa","spinner"]}})],1),a("div",{staticClass:"row-100 row-title"},[a("div",{staticClass:"page-title"},[a("span",[a("h3",[t._v(t._s(t.tempProduct.id?"更新":"新增")+"商品")])])])]),a("div",{staticClass:"row"},[a("label",{attrs:{for:"title"}},[t._v("名稱")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.tempProduct.title,expression:"tempProduct.title"}],staticClass:"required",attrs:{id:"title",type:"text"},domProps:{value:t.tempProduct.title},on:{input:function(e){e.target.composing||t.$set(t.tempProduct,"title",e.target.value)}}})]),a("div",{staticClass:"row"},[a("label",{attrs:{for:"ategory"}},[t._v("分類")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.tempProduct.category,expression:"tempProduct.category"}],attrs:{id:"category",type:"text"},domProps:{value:t.tempProduct.category},on:{input:function(e){e.target.composing||t.$set(t.tempProduct,"category",e.target.value)}}})]),a("div",{staticClass:"row"},[a("label",{attrs:{for:"content"}},[t._v("商品敘述")]),a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.tempProduct.content,expression:"tempProduct.content"}],attrs:{id:"content",cols:"25",rows:"5"},domProps:{value:t.tempProduct.content},on:{input:function(e){e.target.composing||t.$set(t.tempProduct,"content",e.target.value)}}})]),a("div",{staticClass:"row"},[a("label",{attrs:{for:"description"}},[t._v("商品說明")]),a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.tempProduct.description,expression:"tempProduct.description"}],attrs:{id:"description",cols:"25",rows:"5"},domProps:{value:t.tempProduct.description},on:{input:function(e){e.target.composing||t.$set(t.tempProduct,"description",e.target.value)}}})]),a("div",{staticClass:"row"},[a("label",{attrs:{for:"origin_price"}},[t._v("原價")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.tempProduct.origin_price,expression:"tempProduct.origin_price"}],attrs:{id:"origin_price",type:"number"},domProps:{value:t.tempProduct.origin_price},on:{input:function(e){e.target.composing||t.$set(t.tempProduct,"origin_price",e.target.value)}}})]),a("div",{staticClass:"row"},[a("label",{attrs:{for:"price"}},[t._v("售價")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.tempProduct.price,expression:"tempProduct.price"}],attrs:{id:"price",type:"number"},domProps:{value:t.tempProduct.price},on:{input:function(e){e.target.composing||t.$set(t.tempProduct,"price",e.target.value)}}})]),a("div",{staticClass:"row"},[a("label",{attrs:{for:"imageUrl"}},[t._v("輸入圖片網址或上傳圖片")]),a("input",{directives:[{name:"model",rawName:"v-model.lazy",value:t.tempProduct.imageUrl[0],expression:"tempProduct.imageUrl[0]",modifiers:{lazy:!0}}],attrs:{id:"imageUrl",type:"text"},domProps:{value:t.tempProduct.imageUrl[0]},on:{change:function(e){return t.$set(t.tempProduct.imageUrl,0,e.target.value)}}}),a("input",{attrs:{id:"uploadImg",type:"file"}}),a("div",{staticClass:"img"},t._l(t.tempProduct.imageUrl,(function(t){return a("img",{key:t,staticClass:"preview",attrs:{src:t,alt:""}})})),0)]),a("div",{staticClass:"row"},[a("label",{attrs:{for:"price"}},[t._v("庫存")]),t.tempProduct.options?a("input",{directives:[{name:"model",rawName:"v-model",value:t.tempProduct.options.store,expression:"tempProduct.options.store"}],attrs:{id:"store",type:"number",placeholder:"0"},domProps:{value:t.tempProduct.options.store},on:{input:function(e){e.target.composing||t.$set(t.tempProduct.options,"store",e.target.value)}}}):t._e(),a("label",{attrs:{for:"unit"}},[t._v("單位")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.tempProduct.unit,expression:"tempProduct.unit"}],attrs:{id:"price",type:"text"},domProps:{value:t.tempProduct.unit},on:{input:function(e){e.target.composing||t.$set(t.tempProduct,"unit",e.target.value)}}}),a("input",{directives:[{name:"model",rawName:"v-model",value:t.tempProduct.enabled,expression:"tempProduct.enabled"}],attrs:{id:"enabled",type:"checkbox"},domProps:{checked:Array.isArray(t.tempProduct.enabled)?t._i(t.tempProduct.enabled,null)>-1:t.tempProduct.enabled},on:{change:function(e){var a=t.tempProduct.enabled,o=e.target,i=!!o.checked;if(Array.isArray(a)){var n=null,c=t._i(a,n);o.checked?c<0&&t.$set(t.tempProduct,"enabled",a.concat([n])):c>-1&&t.$set(t.tempProduct,"enabled",a.slice(0,c).concat(a.slice(c+1)))}else t.$set(t.tempProduct,"enabled",i)}}}),a("label",{attrs:{for:"enabled"}},[t._v("是否啟用")])]),a("div",{staticClass:"row-100"},[t.tempProduct.id?a("button",{attrs:{id:"update","data-action":"update",type:"button"},on:{click:function(e){return e.preventDefault(),t.edit(e)}}},[t._v("更新")]):a("button",{attrs:{id:"create","data-action":"create",type:"button"},on:{click:function(e){return e.preventDefault(),t.edit(e)}}},[t._v("新增")]),a("button",{attrs:{id:"cancel",type:"button"},on:{click:t.cancel}},[t._v("取消")])])])])},l=[],p=(a("caad"),a("2532"),{name:"productPage",props:{addNewItem:Boolean},data:function(){return{formData:new FormData}},computed:Object(c["a"])({},Object(r["c"])(["tempProduct","productPage","loading"])),watch:{"productPage.open":{handler:function(){this.loadProduct()}}},methods:Object(c["a"])(Object(c["a"])({},Object(r["b"])(["setMsg","clearMsg","addProducts","editProduct","setTempProduct","clearTempProduct","toggleProductPage","toggleLoading"])),{},{loadProduct:function(){var t=this;this.tempProduct.id&&(this.toggleLoading(),Object(d["l"])(this.tempProduct.id).then((function(e){var a=e.data.data;a.options?a.options=JSON.parse(a.options):a.options={store:null},t.setTempProduct(a),t.toggleLoading()})))},edit:function(t){var e=this,a=t.target.dataset.action,o=document.querySelector("#uploadImg").files[0];this.formData.append("file",o),o&&Object(d["v"])(this.formData,{headers:{"Content-Type":"multipart/form-data"}}).then((function(t){console.log(t.data.data.id,t.data.data.path),document.querySelector("#uploadImg").value=""})),"create"===a?(this.toggleLoading(),this.tempProduct.options=JSON.stringify(this.tempProduct.options),Object(d["e"])(this.tempProduct).then((function(){e.$emit("update:addNewItem",!0),e.clearTempProduct(),e.toggleLoading(),e.toggleProductPage()})).catch((function(){e.tempProduct.options=JSON.parse(e.tempProduct.options),e.setMsg({msg:"上傳".concat(e.tempProduct.title||"","失敗"),type:!1}),setTimeout((function(){e.clearMsg()}),1e3)}))):"update"===a&&(this.tempProduct.options=JSON.stringify(this.tempProduct.options),Object(d["u"])(this.tempProduct.id,this.tempProduct).then((function(t){var a=t.data.data;"string"===typeof a.options&&(a.options=JSON.parse(a.options)),e.editProduct({id:a.id,data:a}),e.clearTempProduct(),e.toggleProductPage()})).catch((function(){e.tempProduct.options=JSON.parse(e.tempProduct.options),e.setMsg({msg:"更新".concat(e.tempProduct.title,"失敗"),type:!1}),setTimeout((function(){e.clearMsg()}),1e3)})))},cancel:function(){this.clearTempProduct(),this.toggleProductPage()},toggle:function(t){t.target.className.includes("newDataPage")&&(this.clearTempProduct(),this.toggleProductPage())}})}),m=p,g=(a("cd56"),a("2877")),f=Object(g["a"])(m,u,l,!1,null,"8f2f3e2a",null),v=f.exports,P={name:"products",components:{productPage:v,pagination:s["a"]},data:function(){return{loadingConfig:{isLoading:!1,fullPage:!0},pagination:{},windowTop:null,addShow:!1,addNewItem:!1}},created:function(){this.getData()},mounted:function(){window.addEventListener("scroll",this.onScroll)},computed:Object(c["a"])({},Object(r["c"])(["products","productPage"])),watch:{product:function(){this.getData()},"pagination.current_page":{handler:function(){var t=this,e=this.pagination.current_page,a=this.$loading.show();Object(d["k"])(e).then((function(e){var o=e.data.data.map((function(t){var e=t,a=e.options;return"object"!==n(a)&&(e.options=e.options?JSON.parse(e.options):{store:null}),e}));t.setProducts(o),a.hide()}))}},addNewItem:{handler:function(){this.addNewItem&&(this.getData(),this.addNewItem=!1)}}},methods:Object(c["a"])(Object(c["a"])({},Object(r["b"])(["setProducts","delProduct","setTempProduct","clearTempProduct","toggleProductPage"])),{},{getData:function(){var t=this,e=this.$loading.show();Object(d["k"])().then((function(a){var o=a.data.data.map((function(t){var e=t,a=e.options;return"object"!==n(a)&&(e.options=e.options?JSON.parse(e.options):{store:null}),e}));t.setProducts(o),e.hide(),t.pagination=a.data.meta.pagination}))},openPage:function(t){t||0===t?this.setTempProduct(this.products[t]):this.clearTempProduct(),this.toggleProductPage()},deleteProduct:function(t){var e=this,a=this.products[t].title;this.$confirm({title:"刪除",message:"確認刪除 ".concat(a,"？\r\n（刪除後無法復原）"),button:{no:"取消",yes:"刪除"},callback:function(o){if(o){var i=e.$loading.show();Object(d["h"])(e.products[t].id).then((function(){e.delProduct(t),i.hide(),e.$confirm({message:"已刪除 ".concat(a),button:{no:"OK"}})}))}}})},onScroll:function(){this.windowTop=window.top.scrollY,this.windowTop>200?this.addShow=!0:this.addShow=!1}})},h=P,b=(a("ca63"),Object(g["a"])(h,o,i,!1,null,"1f1865bb",null));e["default"]=b.exports},2532:function(t,e,a){"use strict";var o=a("23e7"),i=a("5a34"),n=a("1d80"),c=a("ab13");o({target:"String",proto:!0,forced:!c("includes")},{includes:function(t){return!!~String(n(this)).indexOf(i(t),arguments.length>1?arguments[1]:void 0)}})},"5a34":function(t,e,a){var o=a("44e7");t.exports=function(t){if(o(t))throw TypeError("The method doesn't accept regular expressions");return t}},ab13:function(t,e,a){var o=a("b622"),i=o("match");t.exports=function(t){var e=/./;try{"/./"[t](e)}catch(a){try{return e[i]=!1,"/./"[t](e)}catch(o){}}return!1}},ba16:function(t,e,a){"use strict";var o=a("eed0"),i=a.n(o);i.a},ca63:function(t,e,a){"use strict";var o=a("db1f"),i=a.n(o);i.a},caad:function(t,e,a){"use strict";var o=a("23e7"),i=a("4d64").includes,n=a("44d2"),c=a("ae40"),r=c("indexOf",{ACCESSORS:!0,1:0});o({target:"Array",proto:!0,forced:!r},{includes:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),n("includes")},cd56:function(t,e,a){"use strict";var o=a("01c6"),i=a.n(o);i.a},d81d:function(t,e,a){"use strict";var o=a("23e7"),i=a("b727").map,n=a("1dde"),c=a("ae40"),r=n("map"),s=c("map");o({target:"Array",proto:!0,forced:!r||!s},{map:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}})},db1f:function(t,e,a){},eed0:function(t,e,a){}}]);
//# sourceMappingURL=chunk-5b0daa49.ef69bf3b.js.map